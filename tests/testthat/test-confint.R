getData <- function() {
  structure(list(diffmean = c(-0.865114560236513, 0.36778884147305, 
  -1.69679327521794, -0.515578957538288, -1.94702093397746, -0.0728026194617826, 
  -1.86344537815125, 0.230871807028976, -0.403286509408957, -1.10612170087977, 
  -0.0187560975609742, -0.937450304797245, 0.336827195467421, -1.20303776683087, 
  0.197786961013534, -0.150530871031052, -1.53303441197126, -2.03656156156156, 
  -1.80459133832628, -0.148356940509913, -1.44662309368191, -1.66299316729116, 
  -2.29584489012161, -0.731077910853188, 0.46941966871308, -1.24377675993229, 
  -0.806121886709278, -1.19370508766887, 1.55603328710125, -0.169223921240054, 
  -2.57113314447592, -2.41906367244848, -1.04849036959916, -0.828693977591037, 
  1.25994772775763, 0.0965588084232181, -0.737388972683092, -0.471512012342956, 
  -0.542079207920793, -2.34084066000241, -1.6808725353206, -0.341452425125894, 
  -0.661978492482326, -0.0747721258453424, -2.27637620874075, -1.66087138667783, 
  -1.70732009311079, -0.523727422003283, -1.61968125474323, -1.90693817628188
  )), class = c("do.data.frame", "data.frame"), row.names = c(NA, -50L), 
  lazy = ~diffmean(age ~ sex, data = resample(HELPrct)), culler = function (object,...) 
  { UseMethod("cull_for_do") })
}

testthat::test_that("Confidence Intervals created", {
  bootstrap <- getData()
  result1 <- structure(list(name = "diffmean", lower = -2.40146349464812, 
                            upper = 1.0820789144726, level = 0.95, method = "percentile", 
                            estimate = -0.784128356112582), row.names = c(NA, -1L), class = "data.frame")
  result2 <- structure(list(name = "diffmean", lower = -2.77996366912654, 
                            upper = 0.989971357711456, level = 0.95, method = "stderr", 
                            estimate = -0.784128356112582, margin.of.error = 1.884967513419, 
                            df = 452), row.names = c(NA, -1L), class = "data.frame")
  
  expect_equal(confint(bootstrap), result1)
  expect_equal(confint(bootstrap, method="stderr"), result2)
  
  
})


